{% extends "elections/election_base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load thumbnail %}
{% load markdown_deux_tags %}
{% load votainteligente_extras %}
{% load thumbnail %}
{% load ogp_tags %}

{% block url_face_to_face %}{% url 'face_to_face_one_candidate_detail_view' slug=election.slug slug_candidate_one=candidate.id %}{% endblock url_face_to_face %}

{% block title %} - {{election}} - {{candidate.name}}{% endblock title%}

{% block tab_profile %}class="active"{% endblock %}
{% block content_container %}{% endblock content_container %}

{% block ogp %}
  {% render_ogp candidate %}
{% endblock ogp %}


{% block mainelection %}
<div class="profile">
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-sm-4 col-xs-12">
					<div id="candidate-img-profile">
						{% if candidate.image %}

						{% thumbnail candidate.image "300x300" crop="center" as im %}
						    <img src="{{ im.url }}" alt="{{candidate.name}}" height="300" width="300" border="0" class="img-responsive img-circle img-candidato">
						{% endthumbnail %}

						{% else %}
						<img src="{% static 'img/candidate-default.jpg' %}" alt="{{candidate.name}}" border="0" class="img-responsive img-circle img-candidato img-candidato">
						{% endif %}

						{% if candidate.extra_info.custom_ribbon %}<div class="ribbon">{{ candidate.extra_info.custom_ribbon }}</div>{% endif %}
					</div>
			</div>
			<div class="col-md-8 col-sm-8 col-xs-12">
				<h1>{{ candidate.name }}</h1>
			</div>
		</div>

		<div class="profile-candidate">
			<div class="row">
				<div class="col-md-3">


				</div>
				<div class="col-md-5">
					{% include 'elections/candidates/extra_info_per_candidate.html' %}
					<table class="table">
						{% include 'elections/candidates/personal_data_candidate.html' with candidate=candidate %}
					</table>
				</div>

				<div class="col-md-4 social-side">
					{% include 'elections/candidates/links_extra_pages.html' with candidate=candidate %}

					{% include 'elections/candidates/contacts.html' with candidate=candidate %}
				</div>
			</div>

			<div class="row">

				<div class="antecedentes col-md-12">
					<div class="info">
					{% for background_category in election.can_election.backgroundcategory_set.all %}
			 			{% for background in background_category.background_set.all %}
			 				{% for background_candidate in background.backgroundcandidate_set.all %}
				 				{{background_candidate.value}}
			 				{% endfor %}
			 			{% endfor %}
			 		{% endfor %}

					{{ candidate.biography|markdown }}
			 		</div>
			 	</div>
			</div>
		</div>

	</div>
</div>

<div class="container">

	{% if 'questionary'|val_navbars and election.uses_questionary  %}
	<div class="questionary">
		<div class="row">
			<div class="col-md-6">
				<h3>{% trans "Cuestionario" %} {% if not candidate.has_answered %}{% no_ha_respondido_twitter_button %}{% endif %}</h3>
			</div>
		</div>
		<ul class="nav nav-tabs nav-justified" role="tablist">
			{% for category in election.categories.all %}
				<li role="presentation" class="{% if forloop.first %}active{% endif %}">
					<a href="#{{category.name|slugify}}" class="small" aria-controls="{{ category.name|slugify }}" role="tab" data-toggle="tab">{{category.name}}</a>
				</li>
			{% endfor %}
		</ul>
		<div class="tab-content">
		{% for category in election.categories.all %}
			<div role="tabpanel" class="tab-pane {% if forloop.first %}active{% endif %}" id="{{category.name|slugify}}">
				{% for topic in category.topics.all %}
				<div class="question-answer" {% if forloop.counter >= 2 %} {% endif %}>
					<h4 class="question text-dark">
						{{topic.label}}
					</h4>
					<p class="answer">
						{% get_taken_position_for topic candidate %}
						<!-- source -->
						<!-- eosource -->
					</p>
				</div>
				{% endfor %}
			</div>
		{% endfor %}
		</div>
	</div>
	{% endif %}

</div>

	<script type="text/javascript">
	var API_KEY = '{{ 'client_id'|website_imgur }}';
	var candidate_name = '{{candidate.name}}';
	var twitter_url = '{% url_domain %}{% url 'candidate_detail_view' election_slug=election.slug slug=candidate.id %}';
	</script>
	<script type="text/javascript" src="{% static 'js/video.js' %}"></script>
{% endblock mainelection %}

{% block extrajs %}
	$(document).ready(function() {
		$('div.antecedentes div.info').expander({
			expandText: '<i class="fa fa-chevron-down" aria-hidden="true"></i>',
			userCollapseText: '<i class="fa fa-chevron-up" aria-hidden="true"></i>',
			slicePoint: 180,
		});

		$('.pop-fuente').popover();
	});
{% endblock extrajs %}
