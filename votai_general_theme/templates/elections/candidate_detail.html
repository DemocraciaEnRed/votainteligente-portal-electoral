{% extends "elections/election_base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load thumbnail %}
{% load markdown_deux_tags %}
{% load votainteligente_extras %}
{% load thumbnail %}
{% load ogp_tags %}

{% block url_face_to_face %}{% url 'face_to_face_one_candidate_detail_view' slug=election.slug slug_candidate_one=candidate.id %}{% endblock url_face_to_face %}

{% block title %} - {{election}} - {{candidate.name}}{% endblock title%}

{% block tab_profile %}class="active"{% endblock %}
{% block content_container %}{% endblock content_container %}
{% block election_breadcrumbs %}{% endblock %}

{% block ogp %}
  {% render_ogp candidate %}
{% endblock ogp %}


{% block mainelection %}
<div class="profile">
	<div class="container">
		<div class="row breadscrumb-social yellow-breadcrumbs">
			<div class="col-md-9">
				<ul class="breadcrumb">
					<li><a href="/">{% trans "Portada" %}</a></li>
					{% if election.area %}
						<li><a href="{% url 'area' slug=election.area.id %}">{{ election.area }}</a></li>
					{% endif %}
					<li><a href="{% url 'election_view' slug=election.slug %}">{{ election }}</a></li>
					<li class="active">{% block last_breadcrumb %}{% trans "Perfiles"%}{% endblock last_breadcrumb %}</li>
				</ul>
			</div>
		</div>
		<div class="row">
			<div class="col-md-2 col-sm-2 col-xs-12">
					<div id="candidate-img-profile">
						{% if candidate.image %}

						{% thumbnail candidate.image "300x300" crop="center" as im %}
						    <img src="{{ im.url }}" alt="{{candidate.name}}" height="300" width="300" border="0" class="img-responsive img-circle img-candidato">
						{% endthumbnail %}

						{% else %}
						<img src="{% static 'img/candidate-default.jpg' %}" alt="{{candidate.name}}" border="0" class="img-responsive img-circle img-candidato img-candidato">
						{% endif %}

<!-- 						{% if candidate.extra_info.custom_ribbon %}<div class="ribbon">{{ candidate.extra_info.custom_ribbon }}</div>{% endif %} -->
					</div>
			</div>
			<div class="col-md-8 col-sm-8 col-xs-12">
				<p class="small text-white">{% get_personal_data candidate=candidate personal_data='Partido' as partido %}{{partido.value}} {% include 'elections/candidates/links_extra_pages.html' with candidate=candidate %}{% include 'elections/candidates/contacts.html' with candidate=candidate %}</p>
				<h1 class="text-white">{{ candidate.name }}</h1>
				{% if user|manages_this:candidate %}
					{% with user.candidacies.first as candidacy %}
					{% url 'backend_candidate:complete_12_naranja' slug=candidacy.candidate.election.slug candidate_id=candidacy.candidate.id  as backend_candidate %}
					<a class="btn btn-primary" href="{{backend_candidate}}" role="button">{% trans 'Actualiza tu perfil' %}</a>
					{% endwith %}
				{% endif %}
				<ul class="text-white">
					{% include 'elections/candidates/extra_info_per_candidate.html' %}
					<!-- {% include 'elections/candidates/personal_data_candidate.html' with candidate=candidate %} -->
					<li>Pacto: {% get_personal_data candidate=candidate personal_data='Pacto' as pacto %}{{pacto.value}}</li>
					<li>Edad: {% get_personal_data candidate=candidate personal_data='age' as edad %}{{edad.value}}</li>
					<li>Lema de campaña: {% get_personal_data candidate=candidate personal_data='lema' as lema %}{{lema.value}}</li>
					<li>Ocupación: {% get_personal_data candidate=candidate personal_data='ocupacion' as ocupacion %}{{ocupacion.value}}</li>
					<li>Experiencia en cargos públicos: {% get_personal_data candidate=candidate personal_data='experiencia' as experiencia %}{{experiencia.value}}</li>
				</ul>

				<h3 class="text-white">Propuestas ciudadanas a las que ha adherido:</h3>
				<ul>
					<li class="text-white">Propuesta</li>
				</ul>
			</div>
		</div>

		<div>

				<div class="antecedentes text-white">
					<div class="info">
					{% for background_category in election.can_election.backgroundcategory_set.all %}
			 			{% for background in background_category.background_set.all %}
			 				{% for background_candidate in background.backgroundcandidate_set.all %}
				 				{{background_candidate.value}}
			 				{% endfor %}
			 			{% endfor %}
			 		{% endfor %}

					{{ candidate.biography|markdown }}
			 		</div>
			 	</div>
		</div>

	</div>
</div>

<div class="container">

	{% if 'questionary'|val_navbars and election.uses_questionary  %}
	<div class="questionary">
		<div class="row">
			<div class="col-md-6">
				<h3>{% if not candidate.has_answered %}{% no_ha_respondido_twitter_button %}{% endif %}</h3>
			</div>
		</div>
		<ul class="nav nav-tabs nav-justified" role="tablist">
			{% for category in election.categories.all %}
				<li role="presentation" class="{% if forloop.first %}active{% endif %}">
					<a href="#{{category.name|slugify}}" class="small" aria-controls="{{ category.name|slugify }}" role="tab" data-toggle="tab">{{category.name}}</a>
				</li>
			{% endfor %}
		</ul>
		<div class="tab-content">
		{% for category in election.categories.all %}
			<div role="tabpanel" class="tab-pane {% if forloop.first %}active{% endif %}" id="{{category.name|slugify}}">
				{% for topic in category.topics.all %}
				<div class="question-answer" {% if forloop.counter >= 2 %} {% endif %}>
					<h4 class="question text-dark">
						{{topic.label}}
					</h4>
					<p class="answer">
						{% get_taken_position_for topic candidate %}
						<!-- source -->
						<!-- eosource -->
					</p>
				</div>
				{% endfor %}
			</div>
		{% endfor %}
		</div>
	</div>
	{% endif %}

</div>

	<script type="text/javascript">
	var API_KEY = '{{ 'client_id'|website_imgur }}';
	var candidate_name = '{{candidate.name}}';
	var twitter_url = '{% url_domain %}{% url 'candidate_detail_view' election_slug=election.slug slug=candidate.id %}';
	</script>
	<script type="text/javascript" src="{% static 'js/video.js' %}"></script>
{% endblock mainelection %}

{% block extrajs %}
	$(document).ready(function() {
		$('div.antecedentes div.info').expander({
			expandText: '<span class="fa-stack fa-2x"><i class="fa fa-circle fa-stack-2x" aria-hidden="true"></i><i class="fa fa-chevron-down fa-stack-1x fa-inverse" aria-hidden="true"></i></span>',
			userCollapseText: '<span class="fa-stack fa-2x"><i class="fa fa-circle fa-stack-2x" aria-hidden="true"></i><i class="fa fa-chevron-up fa-stack-1x fa-inverse" aria-hidden="true"></i></span>',
			slicePoint: 180,
		});

		$('.pop-fuente').popover();
	});
{% endblock extrajs %}
