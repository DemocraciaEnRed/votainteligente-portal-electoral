{% load thumbnail %}
{% load static %}

<div id="election-area-{{election.area.id}}" class="container" itemscope>
  {% if election %}
  <div class="text-center">
  <h2>{{election.name}}</h2>
  {% if election.area.get_containing_filterable_areas %}
    <h4>Comunas</h4>
      {% for comuna in election.area.get_containing_filterable_areas %}
        {{comuna}}
        {% if not forloop.last %}
        ,
        {% endif%}
      {% endfor %}
  {% endif %}
  </div>
  <div class="row">
    {% for candidate in election.candidates.all %}
    <div class="col-md-3">
      <div class="panel-heading">
        {% if candidate.image %}
        {% thumbnail candidate.image "300x300" crop="center" as im %}
          <a href="{{candidate.get_absolute_url}}"><img src="{{ im.url }}" alt="{{ candidate.name }}" border="0" class="img-responsive img-circle" itemprop="image" /></a>
        {% endthumbnail %}
        {% else %}
          <a href="{{candidate.get_absolute_url}}"><img src="{% static 'img/candidate-default.jpg' %}" alt="{{candidate.name}}" border="0" class="img-responsive img-circle"></a>
        {% endif %}
      </div>
      <div class="panel panel-default">
        <div class="panel-body">
          <a href="{{candidate.get_absolute_url}}" itemprop="name"><h3 class="candidate-name-card">{{ candidate.name }}</h3></a>
          {% if candidate.commitments.exists %}
            <p class="candidate-commitment-card">{{ candidate.commitments.count }} compromisos</p>
          {% endif %}
        </div>
      </div>
    </div>
    {% if forloop.counter|divisibleby:4 %}
    </div><div class="row">
    {% endif %}
    {% endfor %}
    {% if user.is_staff %}
    <a href="{% url 'help_election' slug=election.slug %}">Ayudanos!</a>
    {% endif %}
  </div>
  {% else %}
  {% endif %}
</div>
