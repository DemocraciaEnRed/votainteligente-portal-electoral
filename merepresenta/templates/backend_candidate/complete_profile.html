{% extends "backend_base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load thumbnail %}
{% load bootstrap4 %}

{% block extrajs %}
{% endblock extrajs %}

{% block content %}

  <div class='row'>
    <div class="col-2">
      {% if candidate.candidacy_set.first.user.profile.image %}
        <img src="{{candidate.candidacy_set.first.user.profile.image.url}}" alt="{{candidate.name}}" height="96" width="96" border="0" class="img-responsive img-circle">
      {% else %}
        <img src="{% static 'img/candidate-default.jpg' %}" alt="{{candidate.name}}" border="0" class="img-responsive img-circle">
      {% endif %}
      <div>
        <h5>Dados do TSE</h5>
        <ul class="list-group list-group-flush desc_candidato">
          <li class="list-group-item">{{candidate.name|title}}</li>
          <li class="list-group-item">{{candidate.partido.initials}}</li>
          <li class="list-group-item">{{candidate.election.name|title}}</li>
          <li class="list-group-item">Número de urna {{candidate.numero}}</li>
          <li class="list-group-item">{{candidate.data_de_nascimento}}</li>
          <li class="list-group-item">{{candidate.election.area.name|title}}</li>
        </ul>
      </div>
    </div>
    <div class="col-8 ">
      <h1>Olá, {{candidate.name}}:</h1>
      <p>Obrigada por ingressar na nossa plataforma! Agora precisamos de algumas informações sobre quem você é. As questões identitárias poderão ser utilizadas pelos eleitores para filtrarem as candidaturas.</p>

      <form id='form_candidate_profile' method="post"  enctype="multipart/form-data" action="{% url 'merepresenta_complete_profile' slug=election.slug candidate_slug=candidate.slug %}">{% csrf_token %}
      <!-- image -->
          {% for field in form %}
          <section class="profile-question">
            {% if field.name == 'email' %}
            <span class="label_question">{% bootstrap_label field.label %}</span>
            {% elif field.name == 'lgbt' %}
            <span class="label_question">{% bootstrap_label 'Você se declara LGBT?' %}</span>
            {% elif field.name == 'candidatura_coletiva' %}
            <span class="label_question">{% bootstrap_label 'Você faz parte de uma Candidatura Coletiva?' %}</span>
            {% else %}
            <span class="label_question">{% bootstrap_label field.label %}</span>
            {% endif %}
            {% if field.name == 'email' %}
              <ul>

                {% for type, mail in candidate.emails.items %}
                 <input type="radio" name="email_previous" value="{{mail}}" {% if type == 'email' %}checked{% endif %}> {{mail}} ({{type}})<br>
                {% endfor %}
                <input type="radio" name="email_previous" value="outro" required="False"> Outro<br>
              </ul>
              <input type="email" name="email" title="" placeholder="Outro" class="form-control" id="id_email" />
            {% elif field.name == 'lgbt' or field.name == 'candidatura_coletiva' %}
              <br>
              {% bootstrap_field field  show_label=False show_help=False  %}
            {% else %}

              {% bootstrap_field field  show_label=False show_help=False %}
            {% endif %}
          </section>
          {% endfor %}

        <input type="submit" value="{% trans "Guardar" %}"  class="btn btn-default" />
        </form>
      </div>

  </div>
  <script type="text/javascript">
  $(function(){
    let pass_email = function(event){
      let checkbox = $('input[name=email_previous]:checked');
      let val = checkbox.val()
      if (val != 'outro'){
        $('input[name=email]').val(val);
      }
    }
    $('#form_candidate_profile').submit(pass_email);
  });
  </script>
{% endblock content %}
